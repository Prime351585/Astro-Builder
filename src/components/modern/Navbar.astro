---
import { Image } from "astro:assets";
import icon from "/public/icon.webp";
import instagramIcon from "/public/instagram-icon.svg";
import linkedinIcon from "/public/linkedin-icon.svg";
---

<header class="fixed w-full z-50 transition-all duration-300" id="main-header">
    <!-- Top Bar -->
    <div
        class="topbar bg-black text-white py-2 text-xs md:text-sm hidden md:block border-b border-white/10"
    >
        <div class="container mx-auto px-4 flex justify-between items-center">
            <div class="flex items-center gap-6">
                <a
                    href="mailto:info@dwizzyinfra.com"
                    class="flex items-center hover:text-primary transition-colors"
                >
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        class="h-4 w-4 mr-2 text-primary"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke="currentColor"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
                        ></path>
                    </svg>
                    info@dwizzyinfra.com
                </a>
                <a
                    href="tel:+919555580002"
                    class="flex items-center hover:text-primary transition-colors"
                >
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        class="h-4 w-4 mr-2 text-primary"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke="currentColor"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"
                        ></path>
                    </svg>
                    +91 9555580002
                </a>
            </div>
            <div class="flex items-center gap-4">
                <span class="text-gray-400">Follow Us:</span>
                <a
                    href="https://www.instagram.com/dwizzy_infra/"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="hover:opacity-80 transition-opacity"
                >
                    <Image
                        format="avif"
                        class="w-4 h-4 invert"
                        src={instagramIcon}
                        alt="Instagram"
                    />
                </a>
                <a
                    href="https://www.linkedin.com/company/dwizzy-infra"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="hover:opacity-80 transition-opacity"
                >
                    <Image
                        format="avif"
                        class="w-4 h-4 invert"
                        src={linkedinIcon}
                        alt="LinkedIn"
                    />
                </a>
            </div>
        </div>
    </div>

    <!-- Main Navigation -->
    <nav
        class="bg-white/95 backdrop-blur-md transition-all duration-300 py-4"
        id="navbar"
    >
        <div class="container mx-auto px-4 flex justify-between items-center">
            <!-- Logo -->
            <a href="/" class="flex items-center group">
                <Image
                    format="avif"
                    class="w-20 md:w-24 transition-transform duration-300 group-hover:scale-105"
                    src={icon}
                    alt="Dwizzy Infra Logo"
                />
            </a>

            <!-- Desktop Menu -->
            <div class="hidden lg:flex items-center gap-8">
                <ul class="flex space-x-8 font-medium text-black">
                    <li>
                        <a
                            href="/"
                            class="relative hover:text-primary transition-colors py-2 group"
                        >
                            Home
                            <span
                                class="absolute bottom-0 left-0 w-0 h-0.5 bg-primary transition-all duration-300 group-hover:w-full"
                            ></span>
                        </a>
                    </li>
                    <li>
                        <a
                            href="/about/"
                            class="relative hover:text-primary transition-colors py-2 group"
                        >
                            About Us
                            <span
                                class="absolute bottom-0 left-0 w-0 h-0.5 bg-primary transition-all duration-300 group-hover:w-full"
                            ></span>
                        </a>
                    </li>
                    <li>
                        <a
                            href="/services/"
                            class="relative hover:text-primary transition-colors py-2 group"
                        >
                            Services
                            <span
                                class="absolute bottom-0 left-0 w-0 h-0.5 bg-primary transition-all duration-300 group-hover:w-full"
                            ></span>
                        </a>
                    </li>
                    <li>
                        <a
                            href="/projects/"
                            class="relative hover:text-primary transition-colors py-2 group"
                        >
                            Projects
                            <span
                                class="absolute bottom-0 left-0 w-0 h-0.5 bg-primary transition-all duration-300 group-hover:w-full"
                            ></span>
                        </a>
                    </li>
                    <li>
                        <a
                            href="/certifications/"
                            class="relative hover:text-primary transition-colors py-2 group"
                        >
                            Certifications
                            <span
                                class="absolute bottom-0 left-0 w-0 h-0.5 bg-primary transition-all duration-300 group-hover:w-full"
                            ></span>
                        </a>
                    </li>
                    <li>
                        <a
                            href="/blog/"
                            class="relative hover:text-primary transition-colors py-2 group"
                        >
                            Blog
                            <span
                                class="absolute bottom-0 left-0 w-0 h-0.5 bg-primary transition-all duration-300 group-hover:w-full"
                            ></span>
                        </a>
                    </li>
                    <li>
                        <a
                            href="/contact/"
                            class="relative hover:text-primary transition-colors py-2 group"
                        >
                            Contact
                            <span
                                class="absolute bottom-0 left-0 w-0 h-0.5 bg-primary transition-all duration-300 group-hover:w-full"
                            ></span>
                        </a>
                    </li>
                </ul>

                <a
                    href="/contact/"
                    class="px-6 py-3 bg-black text-white font-bold text-sm uppercase tracking-wider hover:bg-primary transition-colors duration-300 hidden xl:block"
                >
                    Get a Quote
                </a>
            </div>

            <!-- Mobile Menu Button -->
            <button
                id="mobile-menu-btn"
                class="lg:hidden text-black p-2 focus:outline-none"
                aria-label="Toggle Menu"
            >
                <svg
                    class="w-8 h-8"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M4 6h16M4 12h16m-7 6h7"></path>
                </svg>
            </button>
        </div>

        <!-- Mobile Menu Overlay -->
        <div
            id="mobile-menu"
            class="fixed top-0 left-0 right-0 bottom-0 w-screen h-screen bg-black/95 z-[9999] transform translate-x-full transition-transform duration-300 lg:hidden flex flex-col justify-center items-center overflow-y-auto"
            style="position: fixed !important;"
        >
            <button
                id="close-menu-btn"
                class="absolute top-6 right-6 text-white p-2"
            >
                <svg
                    class="w-8 h-8"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>

            <ul
                class="flex flex-col space-y-6 text-center text-2xl font-bold text-white"
            >
                <li>
                    <a
                        href="/"
                        class="hover:text-primary transition-colors mobile-link"
                        >Home</a
                    >
                </li>
                <li>
                    <a
                        href="/about/"
                        class="hover:text-primary transition-colors mobile-link"
                        >About Us</a
                    >
                </li>
                <li>
                    <a
                        href="/services/"
                        class="hover:text-primary transition-colors mobile-link"
                        >Services</a
                    >
                </li>
                <li>
                    <a
                        href="/projects/"
                        class="hover:text-primary transition-colors mobile-link"
                        >Projects</a
                    >
                </li>
                <li>
                    <a
                        href="/certifications/"
                        class="hover:text-primary transition-colors mobile-link"
                        >Certifications</a
                    >
                </li>
                <li>
                    <a
                        href="/blog/"
                        class="hover:text-primary transition-colors mobile-link"
                        >Blog</a
                    >
                </li>
                <li>
                    <a
                        href="/contact/"
                        class="hover:text-primary transition-colors mobile-link"
                        >Contact</a
                    >
                </li>
            </ul>

            <div class="mt-12 flex flex-col items-center gap-4">
                <a
                    href="tel:+919555580002"
                    class="text-gray-400 hover:text-white flex items-center gap-2"
                >
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        class="h-5 w-5"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke="currentColor"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"
                        ></path>
                    </svg>
                    +91 9555580002
                </a>
                <div class="flex gap-6 mt-4">
                    <a
                        href="https://www.instagram.com/dwizzy_infra/"
                        target="_blank"
                        class="text-white hover:text-primary"
                    >
                        <Image
                            format="avif"
                            class="w-6 h-6 invert"
                            src={instagramIcon}
                            alt="Instagram"
                        />
                    </a>
                    <a
                        href="https://www.linkedin.com/company/dwizzy-infra"
                        target="_blank"
                        class="text-white hover:text-primary"
                    >
                        <Image
                            format="avif"
                            class="w-6 h-6 invert"
                            src={linkedinIcon}
                            alt="LinkedIn"
                        />
                    </a>
                </div>
            </div>
        </div>
    </nav>
</header>

<div class="h-[100px] md:h-[120px]"></div>
<!-- Spacer for fixed header -->

<script>
    const mobileMenuBtn = document.getElementById("mobile-menu-btn");
    const closeMenuBtn = document.getElementById("close-menu-btn");
    const mobileMenu = document.getElementById("mobile-menu");
    const mobileLinks = document.querySelectorAll(".mobile-link");

    const topbar = document.querySelector(".topbar") as HTMLElement | null;
    const navbar = document.querySelector("#navbar") as HTMLElement | null;
    let topbarHeight = 0;
    const isMobile = window.innerWidth < 768;

    // Calculate topbar height only on desktop
    if (topbar && !isMobile) {
        topbarHeight = topbar.offsetHeight;
    }

    // Single scroll event listener for all scroll effects
    window.addEventListener("scroll", () => {
        const scrollY = window.scrollY;

        // Topbar slide-up and navbar positioning (desktop only)
        if (!isMobile && topbar && navbar && topbarHeight > 0) {
            if (scrollY > topbarHeight) {
                // Slide topbar up
                topbar.style.transform = "translateY(-100%)";
                topbar.style.transition = "transform 0.3s ease-in-out";
                // Move navbar to top
                navbar.style.transform = `translateY(-${topbarHeight}px)`;
                navbar.style.transition = "transform 0.3s ease-in-out";
            } else {
                // Show topbar
                topbar.style.transform = "translateY(0)";
                topbar.style.transition = "transform 0.3s ease-in-out";
                // Reset navbar position
                navbar.style.transform = "translateY(0)";
                navbar.style.transition = "transform 0.3s ease-in-out";
            }
        }

        // Navbar shadow and padding effect (all devices)
        if (scrollY > 50) {
            navbar?.classList.add("shadow-md", "py-2");
            navbar?.classList.remove("py-4");
        } else {
            navbar?.classList.remove("shadow-md", "py-2");
            navbar?.classList.add("py-4");
        }
    });

    // Mobile Menu Toggle
    function toggleMenu() {
        mobileMenu?.classList.toggle("translate-x-full");
        document.body.classList.toggle("overflow-hidden");
    }

    mobileMenuBtn?.addEventListener("click", toggleMenu);
    closeMenuBtn?.addEventListener("click", toggleMenu);

    mobileLinks.forEach((link) => {
        link.addEventListener("click", toggleMenu);
    });
</script>
