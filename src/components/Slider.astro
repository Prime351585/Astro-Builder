---
// ImageSlider.astro
import Image from "astro/components/Image.astro";
const images = [
  { src: "/SliderImages/1.webp", alt: "monopole", title: "Monopole Erection" },
  { src: "/SliderImages/2.webp", alt: "Special Cage", title: "Special Cage Construction" },
  { src: "/SliderImages/3.webp", alt: "Pile Foundation", title: "Pile Foundation" },
  // { src: "/SliderImages/4.webp", alt: "Waterfall", title: "Pile Chipping" },
  // { src: "/SliderImages/5.webp", alt: "Waterfall", title: "Piling Job With Hydraulic Rig Machine" },
  // { src: "/SliderImages/6.webp", alt: "Monopole Transmission", title: "66 kV Monopole Transmission" },
];
---

<div class="relative w-full overflow-hidden h-[300px] lg:h-[600px] 2xl:h-[800px]" id="image-slider">
  <div class="flex transition-transform duration-700 ease-in-out h-full" id="slider-container">
    {images.map((image, index) => (
      <div class="flex-shrink-0 w-full" style="height: 100%;">
        <div class="relative" style="height: 100%;">
          <Image
            src={image.src}
            alt={image.alt}
            width="100"
            height="100"
            class="w-full h-full object-cover"
          />
          <div class="absolute inset-0 flex items-center bg-gradient-to-r from-black/70 via-black/50 to-transparent">
            <div class="ml-10 lg:ml-20 text-white max-w-3xl">
              <h2 class="text-3xl lg:text-6xl 2xl:text-8xl font-bold mb-4 lg:mb-8 animate-fadeIn">
                <div class="mb-2 lg:mb-4 bg-gradient-to-r from-primary to-orange-600 bg-clip-text text-transparent">Dwizzy Infra</div>
                <div class="mb-2 lg:mb-4">We Do Easy</div>
                <div class="text-2xl lg:text-4xl 2xl:text-6xl font-semibold">{image.title}</div>
              </h2>
            </div>
          </div>
        </div>
      </div>
    ))}
  </div>

  <div class="absolute inset-x-0 bottom-0 h-2 bg-gray-800/50">
    <div class="h-full bg-gradient-to-r from-primary to-orange-600 transition-all duration-500 ease-in-out shadow-lg shadow-primary/50" id="progress-bar"></div>
  </div>

  <div class="absolute inset-y-0 left-0 flex items-center">
    <button id="prev-button" class="bg-white/80 backdrop-blur-sm p-3 lg:p-4 rounded-r-2xl shadow-xl hover:bg-primary hover:text-white transition-all duration-300 transform hover:scale-110 group">
      <svg class="w-6 h-6 lg:w-8 lg:h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
      </svg>
    </button>
  </div>

  <div class="absolute inset-y-0 right-0 flex items-center">
    <button id="next-button" class="bg-white/80 backdrop-blur-sm p-3 lg:p-4 rounded-l-2xl shadow-xl hover:bg-primary hover:text-white transition-all duration-300 transform hover:scale-110 group">
      <svg class="w-6 h-6 lg:w-8 lg:h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
      </svg>
    </button>
  </div>
</div>

<style>
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .animate-fadeIn {
    animation: fadeIn 1s ease-out;
  }
</style>

<script>
  const sliderContainer = document.getElementById('slider-container');
  const prevButton = document.getElementById('prev-button');
  const nextButton = document.getElementById('next-button');
  const progressBar = document.getElementById('progress-bar');
  const imageCount = document.querySelectorAll('#slider-container > div').length;
  let currentIndex = 0;
  let autoSlideInterval: number | any;

  function updateSlider() {
    if (sliderContainer) {
      sliderContainer.style.transform = `translateX(-${currentIndex * 100}%)`;
    }
    if (progressBar) {
      progressBar.style.width = `${((currentIndex + 1) / imageCount) * 100}%`;
    }
  }

  function slideImage(direction: number) {
    currentIndex = (currentIndex + direction + imageCount) % imageCount;
    updateSlider();
    resetAutoSlide();
  }

  function startAutoSlide() {
    autoSlideInterval = setInterval(() => {
      slideImage(1);
    }, 5000); // Change slide every 5 seconds
  }

  function resetAutoSlide() {
    clearInterval(autoSlideInterval);
    startAutoSlide();
  }

  if (prevButton) {
    prevButton.addEventListener('click', () => slideImage(-1));
  }
  if (nextButton) {
    nextButton.addEventListener('click', () => slideImage(1));
  }

  // Initialize the slider and start auto-sliding
  updateSlider();
  startAutoSlide();

  // Optional: Pause auto-sliding when hovering over the slider

</script>